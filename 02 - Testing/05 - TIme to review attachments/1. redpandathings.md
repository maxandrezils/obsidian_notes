# Architecture Testing

## How it will Actually Work.****
1. Once an instruction is "In Progress", the clinician presses the status button, this will go the existing Django interface for the Provisional Report.
2. The Django interface will load the provisional report and the attachments.
    2.1. The attachments that have been successfully downloaded and redacted will be displayed under the supported attachments section.
    2.2. The attachments that have not been redacted will be displayed under the unsupported attachments section.
3. Clicking a paperclip icon will open the React page for the attachment.
    3.1. If it is the first time accessing the page for the report a token will be created by EMR to pass to the react page to pass auth from Django to the react page.
         3.1.1. If the user is returning to the page, the previous token should be used.
         3.1.2. Lifespan of the token?
         3.1.3. Other considerations
    3.2. The selected PDF is opened.
    3.3. If any redactions were applied to the attachment by the AI model, the page will display the redactions.
    3.4. The patient details are passed into the page, authed request.

## EMR
- Apply Auto redaction to attachments >> Both should return the user to the pipeline/eMR+ dashboard
    - YES >> Redpanda should do the things
    - NO >> Redpanda retrieves the attachments and returns them to emr


## Manual Redactions
Instead of highlighting words on quiljs, a user would manually draw rectangles on the document in order to redact blocks from the pdf.
- All redactions would process async, but the list of redactions would add an icon that shows whether the redaction is still in progress
- Revisit text in modals
1. Manual Redactions should be applied asynchronously,
	1. Spinning Icon for the paper clip while redactions are being applied.
	2. Once the redaction is applied, a success toast should be displayed. 
		1. Entry in the list of PDFs is has a label added to it for the edited records
	3. if manual redaction fails, a failure toast should be displayed and persisted for x seconds

		 

## Auth
This includes the following:
1 - Checking authentication on page open
2 - Checking permissions on page open
3 - Logic and navigation on click of "Logout"
4 - Expose apis on existing django to facilitate this logic.


## Provisional Report


## Final Report

## Additional Notes
- Celery and RabbitMQ are not going away.


